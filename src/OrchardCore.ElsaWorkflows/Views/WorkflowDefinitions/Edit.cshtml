@using OrchardCore.Mvc.Core.Utilities
@model OrchardCore.ElsaWorkflows.Controllers.WorkflowDefinitions.Edit.EditViewModel

<link rel="manifest" asp-src="~/OrchardCore.ElsaWorkflows/_content/Elsa.Studio.Shell/site.webmanifest"/>
<link rel="preconnect" asp-src="https://fonts.googleapis.com"/>
<link rel="preconnect" asp-src="https://fonts.gstatic.com" crossorigin/>
<link asp-src="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet"/>
<link asp-src="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;700&display=swap" rel="stylesheet"/>
<link asp-src="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<link asp-src="https://fonts.googleapis.com/css2?family=Grandstander:wght@100&display=swap" rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/_content/MudBlazor/MudBlazor.min.css" rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/_content/CodeBeam.MudBlazor.Extensions/MudExtensions.min.css"
      rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/_content/Radzen.Blazor/css/material-base.css" rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/_content/Elsa.Studio.Shell/css/shell.css" rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/Elsa.Studio.Host.CustomElements.styles.css" rel="stylesheet"/>

<elsa-workflow-definition-editor
    remote-endpoint="@Url.ToAbsoluteUrl("~/elsa/api")"
    definition-id="@Model.DefinitionId"></elsa-workflow-definition-editor>
<div id="blazor-error-ui">
    An unhandled error has occurred.
    <a href="" class="reload">Reload</a>
    <a class="dismiss">ðŸ—™</a>
</div>

<script at="Foot" depends-on="monaco, admin" asp-name="elsamonaco">
    require(['vs/editor/editor.main'], function () {});

</script>
<script asp-src="~/OrchardCore.ElsaWorkflows/_content/BlazorMonaco/jsInterop.js" at="Foot" depends-on="elsamonaco"></script>
<script asp-src="~/OrchardCore.ElsaWorkflows/_content/MudBlazor/MudBlazor.min.js" at="Foot"></script>
<script asp-src="~/OrchardCore.ElsaWorkflows/_content/CodeBeam.MudBlazor.Extensions/MudExtensions.min.js" at="Foot"></script>
<script asp-src="~/OrchardCore.ElsaWorkflows/_content/Radzen.Blazor/Radzen.Blazor.js" at="Foot"></script>
<script asp-src="~/OrchardCore.ElsaWorkflows/_framework/blazor.webassembly.js" autostart="false" at="Foot"></script>

<script at="Foot">
    const basePath = '@Url.Content("~/OrchardCore.ElsaWorkflows")';
    
    document.addEventListener('DOMContentLoaded', function () {
        Blazor.start({
            loadBootResource: function (type, name, defaultUri, integrity) {
                console.log('loadBootResource', type, name, defaultUri, integrity);
                switch (name) {
                    case 'dotnet.js':
                        return `${basePath}/${defaultUri}`;
                }
                
                return defaultUri;
            }
        });
    });
</script>
