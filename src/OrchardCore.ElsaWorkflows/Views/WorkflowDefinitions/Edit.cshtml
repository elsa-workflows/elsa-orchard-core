@model OrchardCore.ElsaWorkflows.Controllers.WorkflowDefinitions.Edit.EditViewModel

<link rel="manifest" asp-src="~/OrchardCore.ElsaWorkflows/_content/Elsa.Studio.Shell/site.webmanifest"/>
<link rel="preconnect" asp-src="https://fonts.googleapis.com"/>
<link rel="preconnect" asp-src="https://fonts.gstatic.com" crossorigin/>
<link asp-src="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet"/>
<link asp-src="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500;700&display=swap" rel="stylesheet"/>
<link asp-src="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<link asp-src="https://fonts.googleapis.com/css2?family=Grandstander:wght@100&display=swap" rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/_content/MudBlazor/MudBlazor.min.css" rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/_content/CodeBeam.MudBlazor.Extensions/MudExtensions.min.css"
      rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/_content/Radzen.Blazor/css/material-base.css" rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/_content/Elsa.Studio.Shell/css/shell.css" rel="stylesheet"/>
<link asp-src="~/OrchardCore.ElsaWorkflows/Elsa.Studio.Host.CustomElements.styles.css" rel="stylesheet"/>

<zone Name="Title"><h1>@RenderTitleSegments(T["Edit Workflow Definition"])</h1></zone>

<div asp-validation-summary="ModelOnly"></div>
<form asp-action="Create" method="post" class="no-multisubmit">
    <ul class="nav nav-tabs">
        <li class="nav-item pe-md-2">
            <a class="nav-link active" id="designer-tab" data-bs-toggle="tab" href="#designer" role="tab"
               aria-controls="site" aria-selected="true">@T["Designer"]</a>
        </li>
    </ul>

    <div class="tab-content" id="tabs">
        <div class="tab-pane fade show active" id="designer" role="tabpanel" aria-labelledby="designer-tab">
            <elsa-workflow-definition-editor definition-id="@Model.DefinitionId"></elsa-workflow-definition-editor>
        </div>
    </div>

    <div class="mb-3">
        <button class="btn btn-primary save" type="submit">@T["Save"]</button>
        <a class="btn btn-secondary cancel" role="button" href="@Url.Action("List")">@T["Cancel"]</a>
    </div>
</form>

<div id="blazor-error-ui">
    An unhandled error has occurred.
    <a href="" class="reload">Reload</a>
    <a class="dismiss">ðŸ—™</a>
</div>
<script asp-src="~/OrchardCore.ElsaWorkflows/_content/BlazorMonaco/jsInterop.js" at="Foot"></script>
@* <script asp-src="~/OrchardCore.ElsaWorkflows/_content/BlazorMonaco/lib/monaco-editor/min/vs/loader.js" at="Foot"></script> *@
@* <script asp-src="~/OrchardCore.ElsaWorkflows/_content/BlazorMonaco/lib/monaco-editor/min/vs/editor/editor.main.js" at="Foot"></script> *@
<script asp-src="~/OrchardCore.ElsaWorkflows/_content/MudBlazor/MudBlazor.min.js" at="Foot"></script>
<script asp-src="~/OrchardCore.ElsaWorkflows/_content/CodeBeam.MudBlazor.Extensions/MudExtensions.min.js"
        at="Foot"></script>
<script asp-src="~/OrchardCore.ElsaWorkflows/_content/Radzen.Blazor/Radzen.Blazor.js" at="Foot"></script>
<script asp-src="~/OrchardCore.ElsaWorkflows/_framework/blazor.webassembly.js" autostart="false" at="Foot"></script>

<script at="Foot">
    document.addEventListener('DOMContentLoaded', function () {
        const basePath = '@Url.Content("~/OrchardCore.ElsaWorkflows")';
        const base = document.createElement('base');
        base.href = basePath;
        const head = document.querySelector('head');
        const existingBase = document.querySelector('base');
        if (existingBase) {
            head.replaceChild(base, existingBase);
        } else {
            head.appendChild(base);
        }
        
        Blazor.start({
            loadBootResource: function (type, name, defaultUri, integrity) {
                switch (name) {
                    case 'dotnet.js':
                        return `${basePath}/${defaultUri}`;
                }
                
                return defaultUri;
            }
        });
    });
</script>
